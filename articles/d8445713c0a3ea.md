---
title: "Flutterã§ã®OSåˆ¤å®šã€ç«¯æœ«æƒ…å ±ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±å–å¾—ã‚„æ¯”è¼ƒã®ã‚ã‚Œã“ã‚Œã€å¿™ã—ã„äººå‘ã‘ã€‘"
emoji: "ğŸ“±"
type: "tech"
topics:
  - "flutter"
  - "dart"
published: true
published_at: "2022-02-07 00:39"
---

# ã¯ã˜ã‚ã«
Flutterã§ã®OSåˆ¤å®šã€ç«¯æœ«æƒ…å ±ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±å–å¾—ãªã©ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚‚å«ã‚ã‚‹ã¨å……å®Ÿã—ã¦ã„ã¾ã™ã€‚ã‚ˆãä½¿ã„ãã†ãªã‚ã‚Œï¼Ÿã“ã‚Œã©ã†ã‚„ã‚‹ï¼Ÿã©ã†å–å¾—ã™ã‚‹ï¼Ÿã‚’ç°¡å˜ã«ã¾ã¨ã‚ãŸè¨˜äº‹ã«ãªã‚Šã¾ã™ã€‚

# å¯¾è±¡
ãƒ¢ãƒã‚¤ãƒ«ã®ã¿(Android/iOS)

# OSåˆ¤å®šã—ãŸã„

ã“ã‚Œã¯ã‚ˆãä½¿ã‚ã‚Œã¦ã„ã‚‹ã‚³ãƒ¼ãƒ‰ã ã¨æ€ã†ã®ã§ã™ãŒdart:ioã§ç”¨æ„ã•ã‚Œã¦ã‚‹OSåˆ¤å®šã®ã‚¯ãƒ©ã‚¹ã§ã™
```Dart
// Android
if (Platform.isAndroid) {
 // Androidã§å®Ÿè¡Œã—ãŸã„å‡¦ç†
} 

// iOS
if (Platform.isIOS) {
 // iOSã§å®Ÿè¡Œã—ãŸã„å‡¦ç†
}
```

ãŸã ã€Widgetã®å‡ºã—ã‚ã‘ã®ãŸã‚ã®OSåˆ¤å®šã¯ä»¥ä¸‹è¨˜äº‹ã«ã‚‚è¨˜è¼‰ãŒã‚ã‚Šã¾ã™ãŒã€Themeã‚’ä½¿ã£ãŸåˆ¤å®šã®æ–¹ãŒè‰¯ã•ãã†ã§ã™

```Dart
Theme.of(context).platform == TargetPlatform.androidã€€// Android
Theme.of(context).platform == TargetPlatform.iOSã€€// iOS
```

https://qiita.com/oboenikui/items/5b42b01cedfca9ae0693

# ã‚¢ãƒ—ãƒªåã‚’å–å¾—ã—ãŸã„

package_info_plusãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§å–å¾—ã§ãã¾ã™ (package_infoã®æ–¹ã¯ã‚‚ã†ãƒ¡ãƒ³ãƒ†ã•ã‚Œãªã„ã®ã§ã€package_info_plusã®æ–¹ã‚’ä½¿ã„ã¾ã—ã‚‡ã†)

https://pub.dev/packages/package_info_plus

```Dart
final packageInfo = await PackageInfo.fromPlatform();
final appName = packageInfo.appName; // String
```

# ã‚¢ãƒ—ãƒªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å–å¾—ã—ãŸã„

ã“ã‚Œã‚‚package_info_plusãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§å–å¾—ã§ãã¾ã™

```Dart
final packageInfo = await PackageInfo.fromPlatform();
final version = packageInfo.version; // String 
```

# ã‚¢ãƒ—ãƒªã®ãƒ“ãƒ«ãƒ‰ç•ªå·ã‚’å–å¾—ã—ãŸã„

ã“ã‚Œã‚‚package_info_plusãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§å–å¾—ã§ãã¾ã™

```Dart
final packageInfo = await PackageInfo.fromPlatform();
final buildNumber = packageInfo.buildNumber; // String
```

# OSãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å–å¾—ã—ãŸã„

ã“ã‚Œã¯device_info_plusãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§å–å¾—ã§ãã¾ã™(ã“ã‚Œã‚‚device_infoã®æ–¹ã¯ãƒ¡ãƒ³ãƒ†ã•ã‚Œãªã„ã®ã§ã€device_info_plusã‚’ä½¿ã„ã¾ã—ã‚‡ã†)

https://pub.dev/packages/device_info_plus

ã“ã‚“ãªæ„Ÿã˜ã§å–å¾—ã§ãã¾ã™

```dart
// Android
final androidInfo = await deviceInfo.androidInfo;
final androidOsVersion = androidInfo.version.release!;

// iOS
final iosInfo = await deviceInfo.iosInfo;
final iosOsVersion = iosInfo.systemVersion!;
```

ä¸Šè¨˜ã®OSå˜ä½ã§ã®å–å¾—ã§ãã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ãŒç”¨æ„ã•ã‚Œã¦ã¾ã™ãŒã€åˆ©ç”¨è€…å´ã«OSã‚’æ„è­˜ã›ãšã«ç«¯æœ«æƒ…å ±ã‚’å–å¾—ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ãŒã‚ã‚Šã¾ã™
```Dart
final deviceInfoPlugin = DeviceInfoPlugin();
final deviceInfo = await deviceInfoPlugin.deviceInfo;
```

ä»¥ä¸‹å†…éƒ¨ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã‚‹ã¨OSã”ã¨ã«åˆ†å²ã—ã¦ã„ã¾ã™
https://github.com/fluttercommunity/plus_plugins/blob/8fc1df510e130912ce4153f468ed90bda4b73edb/packages/device_info_plus/device_info_plus/lib/device_info_plus.dart#L84-L103

ã¾ãŸã€Riverpodã‚’çµ„ã¿åˆã‚ã›ãŸã‚„ã‚Šæ–¹ã§éåŒæœŸã§å–å¾—ã«æ™‚é–“ãŒã‹ã‹ã‚‹ã‚‚ã®ã«å¯¾ã—ã¦ã€èµ·å‹•æ™‚ã«äº‹å‰ã«å–å¾—ã—ã¦ProviderScopeã§overridesã•ã›ã‚‹ã‚„ã‚‹æ–¹ã‚‚ã‚ã‚‹ã®ã§è‡ªåˆ†ã¯ã“ã‚“ãªæ„Ÿã˜ã«ã—ã¦ã¾ã™(ã©ã£ã¡ã§ã‚‚ã„ã„ã‹ã‚‚)

â€» Riverpodã¯v1.0.0ä»¥ä¸Š
```Dart
import 'package:device_info_plus/device_info_plus.dart';
import 'package:flutter/material.dart';
import 'package:hooks_riverpod/hooks_riverpod.dart';
import 'package:package_info_plus/package_info_plus.dart';

import 'app.dart';
import 'samples/device_and_packge_info/device_info_provider.dart';
import 'samples/device_and_packge_info/package_info_provider.dart';

Future<void> main() async {
  WidgetsFlutterBinding.ensureInitialized();
  // BaseDeviceInfoã¨ã„ã†abstract classãŒå®šç¾©ã•ã‚Œã¦ã„ã¦
  // å„DeviceInfoã‚¯ãƒ©ã‚¹(AndroidDeviceInfo,IosDeviceInfoã§)ã«implementsã•ã‚Œã¦ã„ã‚‹
  late BaseDeviceInfo deviceInfo; 
  late PackageInfo packageInfo; // PackageInfoinfoã‚‚åŒæ§˜ã«å¯èƒ½

  await Future.wait([
    Future(() async {
      deviceInfo = await DeviceInfoPlugin().deviceInfo;
    }),
    Future(() async {
      packageInfo = await PackageInfo.fromPlatform();
    }),
  ]);

  runApp(
    ProviderScope(
      overrides: [
        deviceInfoProvider.overrideWithValue(deviceInfo),
        packageInfoProvider.overrideWithValue(packageInfo),
      ],
      /// çœç•¥
    ),
  );
}
```

Providerã®å®£è¨€ã¯ä»¥ä¸‹ã¿ãŸã„ãªæ„Ÿã˜ã§ã™

```dart
import 'package:device_info_plus/device_info_plus.dart';
import 'package:hooks_riverpod/hooks_riverpod.dart';
import 'package:package_info_plus/package_info_plus.dart';

final deviceInfoProvider = Provider<BaseDeviceInfo>(
  (_) => throw UnimplementedError(),
);

final packageInfoProvider = Provider<PackageInfo>(
  (ref) => throw UnimplementedError(),
);

```

åˆ©ç”¨æ™‚ã¯ã“ã‚“ãªæ„Ÿã˜ã§ã§ãã¾ã™

```dart
// Widgetã®ãƒ“ãƒ«ãƒ‰é–¢æ•°å†…ã®æƒ³å®š 
final deviceInfo = ref.watch(deviceInfoProvider);

if (Platform.isAndroid) {
    final androidInfo = device as AndroidDeviceInfo;
    final osVersion = androidInfo.version.release!; 
} else if (Platform.isIOS) {
  final iosInfo = device as IosDeviceInfo;
  final osVersion = iosInfo.systemVersion!
} else {
  // ãã‚Œä»¥å¤–
}
```

# æ©Ÿç¨®åã‚’å–å¾—ã—ãŸã„

ã“ã‚Œã‚‚device_info_plusã§å–å¾—ã§ãã¾ã™

```dart
// Android
final androidInfo = await deviceInfo.androidInfo;
final androidOsVersion = androidInfo.device!;

// iOS
final iosInfo = await deviceInfo.iosInfo;
final iosOsVersion = iosInfo.utsname.machine!;
```

æœ€è¿‘ã€è¨˜äº‹ã‚’æ›¸ã‹ã‚ŒãŸ@iseruuuuuã•ã‚“ã®è¨˜äº‹ã«ã‚‚ã‚ã‚‹é€šã‚Šã€iOSã®å ´åˆæ©Ÿç¨®åã‚’å–å¾—ã™ã‚‹ã¨å†…éƒ¨åã§ã®å–å¾—ã«ãªã‚Šã¾ã™ã€‚

https://qiita.com/iseruuuuu/items/4e62ef270ec96598b403#%E8%AA%AC%E6%98%8E

è‡ªåˆ†ã‚‚å†…éƒ¨åã‹ã‚‰ä¸€èˆ¬åã®å¤‰æ›ã«æ‚©ã‚“ã§ã„ãŸã¨ã“ã‚ã€@iseruuuuuã•ã‚“ã®è¨˜äº‹ã‹ã‚‰åç§°ã‚’ç›¸äº’å¤‰æ›ã—ã¦ãã‚Œã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒã‚ã‚‹ã“ã¨ã‚’æœ€è¿‘çŸ¥ã‚Šã¾ã—ãŸ(@iseruuuuuã•ã‚“è¨˜äº‹åŸ·ç­†ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™)

https://pub.dev/packages/apple_product_name

ã“ã‚“ãªæ„Ÿã˜ã§å¤‰æ›ã§ãã¾ã™

```dart
final iosInfo = await deviceInfo.iosInfo;
final iosOsVersion = AppleProductName().lookup(iosInfo.utsname.machine!);
```

# ä»–Androidã®ä½¿ã„ãã†ãªç«¯æœ«æƒ…å ±ã‚’å–å¾—ã—ãŸã„

ä»¥ä¸‹ã®æƒ…å ±ã‚‚device_info_plusãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§å–å¾—ã§ãã¾ã™
```dart
// Android
final androidInfo = await deviceInfo.androidInfo;
final sdkVersion = androidInfo.version.sdkInt!; // ã“ã‚Œã¯int
final brand = androidInfo.brand!; // ä¾‹ æ¥½å¤©ã€Google
```

# (ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒ‹ãƒ³ã‚°ã§ã®)Versionæ¯”è¼ƒãŒã—ãŸã„

versionãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒä¾¿åˆ©ã§ã™

https://pub.dev/packages/version

ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã‚ˆã‚Š
```dart
Version currentVersion = new Version(1, 0, 3);
Version latestVersion = Version.parse("2.1.0"); // æ–‡å­—åˆ—ã‹ã‚‰ã„ã„æ„Ÿã˜ã«ãƒ‘ãƒ¼ã‚¹ã—ã¦ãã‚Œã‚‹staticãƒ¡ã‚½ãƒƒãƒ‰

if (latestVersion > currentVersion) {    
  print("Update is available");
}
```

# è©¦ã—

ä»¥ä¸‹ã‚³ãƒ¼ãƒ‰ã§è‰²ã€…OSåˆ¤å®šã€æƒ…å ±å–å¾—ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³æ¯”è¼ƒã‚’å®Ÿæ©Ÿã§å‹•ã‹ã—ã¦ã¿ã¾ã—ãŸ

## ç’°å¢ƒ
Flutter: 2.5.3(fvmä½¿ç”¨)

```yaml
version: 1.0.0+1

environment:
  sdk: ">=2.14.0 <3.0.0"

dependencies:
  apple_product_name: ^1.0.1
  device_info_plus: ^3.2.1
  flutter:
    sdk: flutter
  flutter_hooks: ^0.18.2
  hooks_riverpod: ^1.0.1
  package_info_plus: ^1.3.0
  version: ^2.0.0

dev_dependencies:
  flutter_test:
    sdk: flutter
```

https://github.com/kentomiya89/k_flutter_playground/blob/main/lib/samples/device_and_packge_info/device_and_package_info_screen.dart

## Android 

ã‚¢ãƒ—ãƒªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚„ç«¯æœ«æƒ…å ±åˆ—æŒ™
![](https://storage.googleapis.com/zenn-user-upload/37b3066373a6-20220206.png =250x)

ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã§OSãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®æ¯”è¼ƒçµæœè¡¨ç¤º

![](https://storage.googleapis.com/zenn-user-upload/be4603e3bed5-20220206.png =250x)

## iOS

ã‚¢ãƒ—ãƒªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚„ç«¯æœ«æƒ…å ±åˆ—æŒ™
![](https://storage.googleapis.com/zenn-user-upload/d7b6cc1d8e79-20220207.png =250x)

ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã§OSãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®æ¯”è¼ƒçµæœè¡¨ç¤º
![](https://storage.googleapis.com/zenn-user-upload/5c5bd0c83a53-20220207.png =250x)

iOSã®ã‚·ãƒ¥ãƒŸãƒ¬ãƒ¼ã‚¿ãƒ¼ã¯ã€`iosInfo.utsname.machine`ã§æ©Ÿç¨®åã‚’å–å¾—ã—ãŸå ´åˆã«ãã®å®Ÿè¡Œã—ã¦ã„ã‚‹æ©Ÿç¨®åã§ã¯ãªãã‚·ãƒ¥ãƒŸãƒ¬ãƒ¼ã‚¿ãƒ¼åã«ãªã‚‹ã®ã§æ³¨æ„ã§ã™

ä½•ã‹é–“é•ã„ã‚„ä»–ã®ç«¯æœ«æƒ…å ±ã‚‚ã‚ˆãå–ã‚‹ã ã‚ã†ã¿ãŸã„ãªä¾‹ãŒã‚ã‚Œã°æ°—è»½ã«ã”é€£çµ¡ãã ã•ã„
